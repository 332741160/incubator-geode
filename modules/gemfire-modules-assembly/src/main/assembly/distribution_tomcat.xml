<assembly
    xmlns="http://maven.apache.org/plugins/maven-assembly-plugin/assembly/1.1.0"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://maven.apache.org/plugins/maven-assembly-plugin/assembly/1.1.0 http://maven.apache.org/xsd/assembly-1.1.0.xsd">
  <id>Tomcat</id>

  <!--
  This assembly descriptor produces output like:
    bin/
      cacheserver.sh
      cacheserver.bat
      gemfire.sh
      gemfire.bat
    conf/
      cache-client.xml
      cache-peer.xml
      cache-server.xml
      context-gemfire.xml
    lib/
      gemfire.modules-version.jar
      gemfire.jar
      open_source_licenses-Pivotal_GemFire_Modules_<version>.txt
  -->

  <!-- Format as zip and tar.gz -->
  <formats>
    <format>zip</format>
  </formats>

  <!-- Don't include a base directory -->
  <includeBaseDirectory>false</includeBaseDirectory>

  <!-- Include gemfire.jar with no version -->
  <dependencySets>
    <dependencySet>
      <outputFileNameMapping>${artifact.artifactId}.${artifact.extension}
      </outputFileNameMapping>
      <outputDirectory>lib</outputDirectory>
      <includes>
        <include>com.gemstone:gemfire-modules</include>
        <include>com.gemstone:gemfire-modules-tomcat7</include>
        <include>org.slf4j:slf4j-api</include>
      </includes>
    </dependencySet>

    <!-- Need a separate set for artifacts with 'provided' scope -->
    <dependencySet>
      <outputFileNameMapping>${artifact.artifactId}.${artifact.extension}
      </outputFileNameMapping>
      <outputDirectory>lib</outputDirectory>
      <includes>
        <include>org.slf4j:slf4j-jdk14</include>
      </includes>
      <directoryMode>0755</directoryMode>
      <fileMode>0644</fileMode>
      <scope>provided</scope>
    </dependencySet>
  </dependencySets>

  <files>
    <file>
      <source>${project.basedir}/release/scripts/cacheserver.sh</source>
      <outputDirectory>bin</outputDirectory>
      <filtered>true</filtered>
      <fileMode>0755</fileMode>
    </file>
    <file>
      <source>${project.basedir}/release/scripts/cacheserver.bat</source>
      <outputDirectory>bin</outputDirectory>
      <filtered>true</filtered>
      <fileMode>0755</fileMode>
    </file>
  </files>

  <fileSets>

    <!--  Include scripts -->
    <fileSet>
      <directory>${project.basedir}/release/scripts</directory>
      <outputDirectory>bin</outputDirectory>
      <excludes>
        <exclude>setenv.properties</exclude>
        <exclude>cacheserver.*</exclude>
      </excludes>
      <fileMode>0644</fileMode>
      <directoryMode>0755</directoryMode>
    </fileSet>

    <!--  Include conf directory files -->
    <fileSet>
      <directory>${project.basedir}/release/conf</directory>
      <outputDirectory>conf</outputDirectory>
    </fileSet>

    <!-- Comment out for GA release
    <fileSet>
      <directory>${project.basedir}</directory>
      <includes>
        <include>
          GFModules_ReleaseNotes.txt
        </include>
      </includes>
      <directoryMode>0755</directoryMode>
      <fileMode>0644</fileMode>
    </fileSet> -->

    <!-- Include 3rd party OSS/TP files -->
    <fileSet>
      <directory>${project.basedir}/release/3rdparty_license</directory>
      <outputDirectory>lib</outputDirectory>
      <includes>
        <include>
          open_source_licenses-Pivotal_GemFire_Modules_8.1.0.txt
        </include>
      </includes>
      <fileMode>0644</fileMode>
      <directoryMode>0755</directoryMode>
    </fileSet>

    <!--  Include readme file -->
    <fileSet>
      <directory>${project.basedir}/target/release/tomcat</directory>
      <outputDirectory></outputDirectory>
      <includes>
        <include>readme.txt</include>
      </includes>
      <fileMode>0644</fileMode>
      <directoryMode>0755</directoryMode>
    </fileSet>

  </fileSets>

</assembly>
